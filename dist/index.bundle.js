(()=>{"use strict";function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.height=i,this.width=e,this.canvas=r,this.canvas.width=16*e,this.canvas.height=16*i,this.canvas.style.imageRendering="pixelated",this.ctx=r.getContext("2d"),this.pixels=new Uint8Array(i*e),this.clear()}var i,r;return i=t,(r=[{key:"get",value:function(e,t){var i=t*this.width+e;return!!this.pixels[i]}},{key:"toggle",value:function(e,t){var i=t*this.width+e;i<this.pixels.length&&(this.pixels[i]^=1)}},{key:"clear",value:function(){for(var e=0;e<this.pixels.length;e++)this.pixels[e]=0}},{key:"getLines",value:function(e,t,i){for(var r=t.split(" "),s=[],a=r[0],n=1;n<r.length;n++){var c=r[n];e.measureText(a+" "+c).width<i?a+=" "+c:(s.push(a),a=c)}return s.push(a),s}},{key:"renderFailure",value:function(e){var t=this.canvas,i=this.ctx,r=t.width/2,s=t.height/2;i.fillStyle="black",i.fillRect(0,0,t.width,t.height),i.font="16px monospace",i.fillStyle="red",i.textAlign="center",i.fillText("The emulator aborted with the following error :(",r,s),s+=16,this.getLines(i,e.message,t.width-10).forEach((function(e){i.textBaseline="top",i.fillText(e,r,s),s+=20}))}},{key:"renderPixel",value:function(e,t){e*=16,t*=16,this.ctx.fillStyle="white",this.ctx.fillRect(e+1,t+1,14,14)}},{key:"render",value:function(){var e=this.ctx;e.fillStyle="black",e.fillRect(0,0,this.canvas.width,this.canvas.height),e.fillStyle="white";for(var t=0;t<this.height;t++)for(var i=0;i<this.width;i++)this.get(i,t)&&this.renderPixel(i,t)}}])&&e(i.prototype,r),t}();function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(e){for(var t=e.toString(16).toUpperCase();t.length<4;)t="0"+t;return"0x"+t},s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t,this.chip=i}var t,s;return t=e,(s=[{key:"doNothing",value:function(){this.chip.pc+=2}},{key:"clear",value:function(){this.chip.screen.clear(),this.chip.pc+=2,this.chip.screenChanged=!0}},{key:"returnFromSubroutine",value:function(){var e=this.chip;e.pc=e.stack[--e.sp]+2}},{key:"jump",value:function(){var e=4095&this.code;this.chip.pc!==e?this.chip.pc=e:this.chip.halted=!0}},{key:"callSubroutine",value:function(){var e=4095&this.code,t=this.chip;if(t.sp>=t.stack.length)throw new Error("Could not enter a subroutine at "+r(e)+"from PC "+r(t.pc)+"because the stack is full.");t.stack[t.sp++]=t.pc,t.pc=e}},{key:"skipIfRegisterEquals",value:function(){var e=this.code,t=this.chip,i=255&e;this.chip.registers[(3840&e)>>8]===i?t.pc+=4:t.pc+=2}},{key:"skipIfRegisterNotEquals",value:function(){var e=this.code,t=this.chip,i=255&e;this.chip.registers[(3840&e)>>8]!==i?t.pc+=4:t.pc+=2}},{key:"skipIfRegistersEqual",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(240&e)>>4;i[(3840&e)>>8]===i[r]?t.pc+=4:t.pc+=2}},{key:"setRegisterValue",value:function(){var e=this.chip,t=this.code,i=(3840&t)>>8,r=255&t;e.registers[i]=r,e.pc+=2}},{key:"addToRegisterValue",value:function(){var e=this.chip,t=this.code,i=(3840&t)>>8,r=255&t;e.registers[i]+=r,e.pc+=2}},{key:"assign",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(240&e)>>4;i[(3840&e)>>8]=i[r],t.pc+=2}},{key:"bitwiseOr",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=(240&e)>>4;i[r]=i[r]|i[s],t.pc+=2}},{key:"bitwiseAnd",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=(240&e)>>4;i[r]=i[r]&i[s],t.pc+=2}},{key:"bitwiseXor",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=(240&e)>>4;i[r]=i[r]^i[s],t.pc+=2}},{key:"add",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=(240&e)>>4,a=i[r]+i[s];i[15]=a>255,i[r]=a,t.pc+=2}},{key:"subtract",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=(240&e)>>4;i[15]=i[r]>=i[s],i[r]-=s,t.pc+=2}},{key:"shiftRight",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8;i[15]=1&i[r],i[r]>>=1,t.pc+=2}},{key:"subtractRegisters",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=(240&e)>>4;i[15]=i[s]>=i[r],i[r]=i[s]-i[r],t.pc+=2}},{key:"shiftLeft",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(3840&e)>>8,s=128&i[r];i[15]=s>0,i[r]<<=1,t.pc+=2}},{key:"skipIfRegistersNotEqual",value:function(){var e=this.code,t=this.chip,i=this.chip.registers,r=(240&e)>>4;i[(3840&e)>>8]!==i[r]?t.pc+=4:t.pc+=2}},{key:"setMemoryRegister",value:function(){var e=4095&this.code;this.chip.registerI=e,this.chip.pc+=2}},{key:"jumpV0",value:function(){var e=4095&this.code;this.chip.pc=this.chip.registers[0]+e}},{key:"rand",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8,r=255&e,s=Math.floor(256*Math.random());t.registers[i]=s&r,t.pc+=2}},{key:"draw",value:function(){var e=this.code,t=this.chip,i=t.registers,r=t.screen,s=(240&e)>>4,a=15&e,n=i[(3840&e)>>8],c=i[s];i[15]=0;for(var o=0;o<a&&c+o<r.height;o++)for(var h=t.memory[t.registerI+o],u=0;u<8;u++)if((h&128>>u)>0){var l=n+u,p=c+o;r.get(l,p)&&(i[15]=1),r.toggle(l,p)}t.pc+=2,t.screenChanged=!0}},{key:"skipIfKeyPressed",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8,r=t.registers[i];t.keyboard[r]?t.pc+=4:t.pc+=2}},{key:"skipIfKeyNotPressed",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8,r=t.registers[i];t.keyboard[r]?t.pc+=2:t.pc+=4}},{key:"getDelayTimer",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8;t.registers[i]=t.delayTimer,t.pc+=2}},{key:"awaitKeyPress",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8;t.halted=!0,t.onNextKeyDown=function(e){t.registers[i]=e,t.halted=!1,t.pc+=2}}},{key:"setDelayTimer",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8;t.delayTimer=t.registers[i],t.pc+=2}},{key:"setSoundTimer",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8;t.soundTimer=t.registers[i],t.pc+=2}},{key:"addMem",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8;t.registerI+=t.registers[i],t.registerI&=65535,t.pc+=2}},{key:"setCharacterInMemory",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8;t.registerI=5*t.registers[i],t.pc+=2}},{key:"storeBCD",value:function(){var e=this.code,t=this.chip,i=(3840&e)>>8,r=t.registers[i],s=t.registerI;t.memory[s+0]=r/100,t.memory[s+1]=r%100/10,t.memory[s+2]=r%10,t.pc+=2}},{key:"dumpRegisters",value:function(){for(var e=this.code,t=this.chip,i=(3840&e)>>8,r=0;r<=i;r++)t.memory[t.registerI+r]=t.registers[r];t.pc+=2}},{key:"loadRegisters",value:function(){for(var e=this.code,t=this.chip,i=(3840&e)>>8,r=0;r<=i;r++)t.registers[r]=t.memory[t.registerI+r];t.pc+=2}},{key:"getInstructionName",value:function(){var e=this.code;switch(61440&e){case 0:switch(255&e){case 224:return"clear";case 238:return"returnFromSubroutine";default:return"doNothing"}case 4096:return"jump";case 8192:return"callSubroutine";case 12288:return"skipIfRegisterEquals";case 16384:return"skipIfRegisterNotEquals";case 20480:return"skipIfRegistersEqual";case 24576:return"setRegisterValue";case 28672:return"addToRegisterValue";case 32768:switch(15&e){case 0:return"assign";case 1:return"bitwiseOr";case 2:return"bitwiseAnd";case 3:return"bitwiseXor";case 4:return"add";case 5:return"subtract";case 6:return"shiftRight";case 7:return"subtractRegisters";case 14:return"shiftLeft"}case 36864:return"skipIfRegistersNotEqual";case 40960:return"setMemoryRegister";case 45056:return"jumpV0";case 49152:return"rand";case 53248:return"draw";case 57344:switch(255&e){case 158:return"skipIfKeyPressed";case 161:return"skipIfKeyNotPressed"}case 61440:switch(255&e){case 7:return"getDelayTimer";case 10:return"awaitKeyPress";case 21:return"setDelayTimer";case 24:return"setSoundTimer";case 30:return"addMem";case 41:return"setCharacterInMemory";case 51:return"storeBCD";case 85:return"dumpRegisters";case 101:return"loadRegisters"}}throw new Error("Unknown instruction: "+r(e)+". At PC "+this.chip.pc)}},{key:"execute",value:function(){this[this.getInstructionName()]()}}])&&i(t.prototype,s),e}();function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const n=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.querySelector(t.canvas),!this.canvas)throw new Error("Canvas not found:",t.canvas);this.audioContext=new(AudioContext||webkitAudioContext)}var i,r;return i=e,(r=[{key:"loadFontSet",value:function(){for(var e=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128],t=0;t<e.length;t++)this.memory[t]=e[t]}},{key:"init",value:function(){this.memory=new Uint8Array(4096),this.loadFontSet(),this.registers=new Uint8Array(16),this.registerI=0,this.pc=512,this.sp=0,this.halted=!0,this.screenChanged=!1,this.stack=new Uint16Array(16),this.delayTimer=0,this.soundTimer=0,this.screen=new t(64,32,this.canvas),this.keyboard=new Uint8Array(16)}},{key:"visualizeMemory",value:function(){for(var e=this.memory,t=0;t<e.length;t+=2){var i=e[t]<<8|e[t+1];0!==i&&console.log(t.toString(16).toUpperCase(),i.toString(16).toUpperCase())}}},{key:"loadRom",value:function(e){if(e instanceof Uint8Array==0)throw new Error("loadRom requires a Uint8Array");if(e.length>3584)throw new Error("ROM too large.");for(var t=0;t<e.length;t++)this.memory[512+t]=e[t]}},{key:"loadRomFromFile",value:function(e){var t=this;return new Promise((function(i,r){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer",s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status)try{var a=new Uint8Array(s.response);t.loadRom(a),i()}catch(e){r(e)}else t.screen.renderFailure(new Error(e+" does not exist"))},s.onerror=r,s.send()}))}},{key:"fetchOpcode",value:function(){return this.memory[this.pc]<<8|this.memory[this.pc+1]}},{key:"executeOpcode",value:function(e){new s(e,this).execute()}},{key:"onKeyDown",value:function(e){if(this.keyboard){console.log(e+" was pressed");var t=parseInt(e,16);isNaN(t)||t>15||(this.keyboard[t]=1,this.onNextKeyDown instanceof Function&&(this.onNextKeyDown(t),this.onNextKeyDown=null,this.cycle()))}}},{key:"onKeyUp",value:function(e){if(this.keyboard){console.log(e+" was released");var t=parseInt(e,16);isNaN(t)||t>15||(this.keyboard[e]=0)}}},{key:"startBeeping",value:function(){if(!this.oscillator){var e=this.audioContext.createOscillator();e.type="square",e.frequency.value=440,e.connect(this.audioContext.destination),e.start(0),this.oscillator=e}}},{key:"stopBeeping",value:function(){this.oscillator&&(this.oscillator.stop(0),this.oscillator.disconnect(this.audioContext.destination),this.oscillator=null)}},{key:"cycle",value:function(){var e=this;if(!this.halted){for(var t=0;t<10;t++){var i=this.fetchOpcode();try{this.executeOpcode(i)}catch(e){throw this.screen.renderFailure(e),e}}this.screenChanged&&(this.screen.render(),this.screenChanged=!1),this.updateTimers(),this.soundTimer>0?this.startBeeping():this.stopBeeping(),setTimeout((function(){e.cycle()}),1e3/60)}}},{key:"updateTimers",value:function(){this.delayTimer>0&&this.delayTimer--,this.soundTimer>0&&this.soundTimer--}},{key:"start",value:function(){this.halted=!1,this.cycle()}},{key:"pause",value:function(){this.halted=!0}}])&&a(i.prototype,r),e}(),c=JSON.parse('[{"bin":"chip8-roms/demos/Maze (alt) [David Winter, 199x].ch8","txt":true},{"bin":"chip8-roms/demos/Maze [David Winter, 199x].ch8","txt":true},{"bin":"chip8-roms/demos/Particle Demo [zeroZshadow, 2008].ch8","txt":true},{"bin":"chip8-roms/demos/Sierpinski [Sergey Naydenov, 2010].ch8","txt":false},{"bin":"chip8-roms/demos/Sirpinski [Sergey Naydenov, 2010].ch8","txt":false},{"bin":"chip8-roms/demos/Stars [Sergey Naydenov, 2010].ch8","txt":false},{"bin":"chip8-roms/demos/Trip8 Demo (2008) [Revival Studios].ch8","txt":true},{"bin":"chip8-roms/demos/Zero Demo [zeroZshadow, 2007].ch8","txt":true},{"bin":"chip8-roms/games/15 Puzzle [Roger Ivie] (alt).ch8","txt":false},{"bin":"chip8-roms/games/15 Puzzle [Roger Ivie].ch8","txt":true},{"bin":"chip8-roms/games/Addition Problems [Paul C. Moews].ch8","txt":false},{"bin":"chip8-roms/games/Airplane.ch8","txt":false},{"bin":"chip8-roms/games/Animal Race [Brian Astle].ch8","txt":true},{"bin":"chip8-roms/games/Astro Dodge [Revival Studios, 2008].ch8","txt":true},{"bin":"chip8-roms/games/Biorhythm [Jef Winsor].ch8","txt":true},{"bin":"chip8-roms/games/Blinky [Hans Christian Egeberg, 1991].ch8","txt":false},{"bin":"chip8-roms/games/Blinky [Hans Christian Egeberg] (alt).ch8","txt":false},{"bin":"chip8-roms/games/Blitz [David Winter].ch8","txt":true},{"bin":"chip8-roms/games/Bowling [Gooitzen van der Wal].ch8","txt":true},{"bin":"chip8-roms/games/Breakout (Brix hack) [David Winter, 1997].ch8","txt":true},{"bin":"chip8-roms/games/Breakout [Carmelo Cortez, 1979].ch8","txt":true},{"bin":"chip8-roms/games/Brick (Brix hack, 1990).ch8","txt":true},{"bin":"chip8-roms/games/Brix [Andreas Gustafsson, 1990].ch8","txt":false},{"bin":"chip8-roms/games/Cave.ch8","txt":false},{"bin":"chip8-roms/games/Coin Flipping [Carmelo Cortez, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Connect 4 [David Winter].ch8","txt":true},{"bin":"chip8-roms/games/Craps [Camerlo Cortez, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Deflection [John Fort].ch8","txt":true},{"bin":"chip8-roms/games/Figures.ch8","txt":false},{"bin":"chip8-roms/games/Filter.ch8","txt":false},{"bin":"chip8-roms/games/Guess [David Winter] (alt).ch8","txt":true},{"bin":"chip8-roms/games/Guess [David Winter].ch8","txt":true},{"bin":"chip8-roms/games/Hi-Lo [Jef Winsor, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Hidden [David Winter, 1996].ch8","txt":true},{"bin":"chip8-roms/games/Kaleidoscope [Joseph Weisbecker, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Landing.ch8","txt":false},{"bin":"chip8-roms/games/Lunar Lander (Udo Pernisz, 1979).ch8","txt":false},{"bin":"chip8-roms/games/Mastermind FourRow (Robert Lindley, 1978).ch8","txt":true},{"bin":"chip8-roms/games/Merlin [David Winter].ch8","txt":true},{"bin":"chip8-roms/games/Missile [David Winter].ch8","txt":false},{"bin":"chip8-roms/games/Most Dangerous Game [Peter Maruhnic].ch8","txt":true},{"bin":"chip8-roms/games/Nim [Carmelo Cortez, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Paddles.ch8","txt":false},{"bin":"chip8-roms/games/Pong (1 player).ch8","txt":false},{"bin":"chip8-roms/games/Pong (alt).ch8","txt":false},{"bin":"chip8-roms/games/Pong 2 (Pong hack) [David Winter, 1997].ch8","txt":false},{"bin":"chip8-roms/games/Pong [Paul Vervalin, 1990].ch8","txt":true},{"bin":"chip8-roms/games/Programmable Spacefighters [Jef Winsor].ch8","txt":true},{"bin":"chip8-roms/games/Puzzle.ch8","txt":false},{"bin":"chip8-roms/games/Reversi [Philip Baltzer].ch8","txt":true},{"bin":"chip8-roms/games/Rocket Launch [Jonas Lindstedt].ch8","txt":false},{"bin":"chip8-roms/games/Rocket Launcher.ch8","txt":false},{"bin":"chip8-roms/games/Rocket [Joseph Weisbecker, 1978].ch8","txt":false},{"bin":"chip8-roms/games/Rush Hour [Hap, 2006] (alt).ch8","txt":false},{"bin":"chip8-roms/games/Rush Hour [Hap, 2006].ch8","txt":true},{"bin":"chip8-roms/games/Russian Roulette [Carmelo Cortez, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Sequence Shoot [Joyce Weisbecker].ch8","txt":true},{"bin":"chip8-roms/games/Shooting Stars [Philip Baltzer, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Slide [Joyce Weisbecker].ch8","txt":true},{"bin":"chip8-roms/games/Soccer.ch8","txt":false},{"bin":"chip8-roms/games/Space Flight.ch8","txt":false},{"bin":"chip8-roms/games/Space Intercept [Joseph Weisbecker, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Space Invaders [David Winter] (alt).ch8","txt":true},{"bin":"chip8-roms/games/Space Invaders [David Winter].ch8","txt":true},{"bin":"chip8-roms/games/Spooky Spot [Joseph Weisbecker, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Squash [David Winter].ch8","txt":false},{"bin":"chip8-roms/games/Submarine [Carmelo Cortez, 1978].ch8","txt":true},{"bin":"chip8-roms/games/Sum Fun [Joyce Weisbecker].ch8","txt":true},{"bin":"chip8-roms/games/Syzygy [Roy Trevino, 1990].ch8","txt":true},{"bin":"chip8-roms/games/Tank.ch8","txt":true},{"bin":"chip8-roms/games/Tapeworm [JDR, 1999].ch8","txt":false},{"bin":"chip8-roms/games/Tetris [Fran Dachille, 1991].ch8","txt":true},{"bin":"chip8-roms/games/Tic-Tac-Toe [David Winter].ch8","txt":false},{"bin":"chip8-roms/games/Timebomb.ch8","txt":false},{"bin":"chip8-roms/games/Tron.ch8","txt":false},{"bin":"chip8-roms/games/UFO [Lutz V, 1992].ch8","txt":true},{"bin":"chip8-roms/games/Vers [JMN, 1991].ch8","txt":false},{"bin":"chip8-roms/games/Vertical Brix [Paul Robson, 1996].ch8","txt":false},{"bin":"chip8-roms/games/Wall [David Winter].ch8","txt":false},{"bin":"chip8-roms/games/Wipe Off [Joseph Weisbecker].ch8","txt":false},{"bin":"chip8-roms/games/Worm V4 [RB-Revival Studios, 2007].ch8","txt":true},{"bin":"chip8-roms/games/X-Mirror.ch8","txt":false},{"bin":"chip8-roms/games/ZeroPong [zeroZshadow, 2007].ch8","txt":false},{"bin":"chip8-roms/hires/Astro Dodge Hires [Revival Studios, 2008].ch8","txt":true},{"bin":"chip8-roms/hires/Hires Maze [David Winter, 199x].ch8","txt":true},{"bin":"chip8-roms/hires/Hires Particle Demo [zeroZshadow, 2008].ch8","txt":true},{"bin":"chip8-roms/hires/Hires Sierpinski [Sergey Naydenov, 2010].ch8","txt":false},{"bin":"chip8-roms/hires/Hires Stars [Sergey Naydenov, 2010].ch8","txt":false},{"bin":"chip8-roms/hires/Hires Test [Tom Swan, 1979].ch8","txt":false},{"bin":"chip8-roms/hires/Hires Worm V4 [RB-Revival Studios, 2007].ch8","txt":true},{"bin":"chip8-roms/hires/Trip8 Hires Demo (2008) [Revival Studios].ch8","txt":true},{"bin":"chip8-roms/programs/BMP Viewer - Hello (C8 example) [Hap, 2005].ch8","txt":true},{"bin":"chip8-roms/programs/Chip8 Picture.ch8","txt":false},{"bin":"chip8-roms/programs/Chip8 emulator Logo [Garstyciuks].ch8","txt":false},{"bin":"chip8-roms/programs/Clock Program [Bill Fisher, 1981].ch8","txt":true},{"bin":"chip8-roms/programs/Delay Timer Test [Matthew Mikolay, 2010].ch8","txt":true},{"bin":"chip8-roms/programs/Division Test [Sergey Naydenov, 2010].ch8","txt":false},{"bin":"chip8-roms/programs/Fishie [Hap, 2005].ch8","txt":true},{"bin":"chip8-roms/programs/Framed MK1 [GV Samways, 1980].ch8","txt":true},{"bin":"chip8-roms/programs/Framed MK2 [GV Samways, 1980].ch8","txt":true},{"bin":"chip8-roms/programs/IBM Logo.ch8","txt":false},{"bin":"chip8-roms/programs/Jumping X and O [Harry Kleinberg, 1977].ch8","txt":true},{"bin":"chip8-roms/programs/Keypad Test [Hap, 2006].ch8","txt":true},{"bin":"chip8-roms/programs/Life [GV Samways, 1980].ch8","txt":true},{"bin":"chip8-roms/programs/Minimal game [Revival Studios, 2007].ch8","txt":false},{"bin":"chip8-roms/programs/Random Number Test [Matthew Mikolay, 2010].ch8","txt":true},{"bin":"chip8-roms/programs/SQRT Test [Sergey Naydenov, 2010].ch8","txt":false}]');for(var o=new n({canvas:"canvas",keyboard:"#keyboard"}),h=null,u=document.querySelectorAll(".button"),l=function(e){var t=u[e];t.onmousedown=function(){t.setAttribute("class","button active"),o.onKeyDown(t.innerText.trim()),h=t},t.onmouseup=function(){h=null,t.setAttribute("class","button"),o.onKeyUp(t.innerText.trim())}},p=0;p<u.length;p++)l(p);document.onmouseup=function(){null!==h&&h.onmouseup()};var m=document.querySelector("#roms"),g=document.querySelector("#instructions"),d={};c.forEach((function(e,t){var i=document.createElement("option"),r=e.bin.split("/"),s=r.pop(),a=r.pop(),n=s.slice(0,-4);i.value=t,i.innerHTML=n,d.hasOwnProperty(a)||(d[a]=[]),d[a].push(i)}));var f=function(e){var t=d[e],i=e[0].toUpperCase()+e.slice(1),r=document.createElement("optgroup");t.forEach((function(e){return r.appendChild(e)})),r.setAttribute("label",i),m.appendChild(r)};for(var v in d)f(v);m.onchange=function(){o.pause(),o.init();var e=this.value,t=c[e],i=t.bin,r=t.txt?t.bin.slice(0,-4)+".txt":null;if(o.loadRomFromFile(i).then((function(){o.start()})),r){var s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&(g.innerHTML=s.responseText||"No instructions")},s.open("GET",r),s.send()}else g.innerHTML="No instructions"};var y=["x","1","2","3","q","w","e","a","s","d","z","c","4","r","f","v"];document.onkeydown=function(e){if(!(e.metaKey||e.ctrlKey||e.shiftKey)){var t=e.key,i=y.indexOf(t);if(i>-1){var r=i.toString(16).toUpperCase(),s=document.querySelector("[data-value='".concat(r,"']"));s&&s.onmousedown()}}},document.onkeyup=function(e){var t=e.key,i=y.indexOf(t);if(i>-1){var r=i.toString(16).toUpperCase(),s=document.querySelector("[data-value='".concat(r,"']"));s&&s.onmouseup()}},window._chip=o})();